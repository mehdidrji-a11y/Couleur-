<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ù„Ù„ Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙˆÙŠØ¨ ÙƒØ§Ù…</title>
    <style>
        /* CSS */
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f4f4f9;
            margin: 20px;
        }

        #video-container {
            border: 2px solid #333;
            margin-bottom: 20px;
            background-color: #000;
        }

        #videoElement {
            width: 100%;
            max-width: 600px;
            display: block;
        }

        #canvas, #color-display {
            border: 1px solid #ccc;
            background-color: #fff;
            max-width: 600px;
            margin: 10px 0;
            cursor: crosshair; /* ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¤Ø´Ø± Ù„Ù„Ø¯Ù„Ø§Ù„Ø© Ø¹Ù„Ù‰ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± */
        }
        
        #color-display {
            height: 50px;
            width: 200px;
            border-radius: 5px;
            text-align: center;
            line-height: 50px;
            font-weight: bold;
            color: #333;
            transition: background-color 0.3s;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #4CAF50;
            color: white;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        #instructions {
            margin-top: 15px;
            padding: 10px;
            border-left: 5px solid #007bff;
            background-color: #e9f7ff;
        }
    </style>
</head>
<body>

    <h2>ğŸ“· Ù…Ø­Ù„Ù„ Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙˆÙŠØ¨ ÙƒØ§Ù…</h2>

    <div id="video-container">
        <video id="videoElement" autoplay playsinline></video>
    </div>

    <button id="captureButton" disabled>Ø§Ù„ØªÙ‚Ø· Ø§Ù„ØµÙˆØ±Ø©</button>

    <canvas id="canvas" style="display: none;"></canvas>

    <div id="instructions">
        **Ø§Ù„Ø®Ø·ÙˆØ§Øª:** 1. Ø§Ø³Ù…Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§. 2. Ø§Ù„ØªÙ‚Ø· Ø§Ù„ØµÙˆØ±Ø©. 3. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù†Ù‚Ø·Ø© ÙÙŠ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ù„ÙˆÙ†Ù‡Ø§.
    </div>
    <div id="color-display">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù„ÙˆÙ†</div>

    <script>
        // JavaScript
        const video = document.getElementById('videoElement');
        const canvas = document.getElementById('canvas');
        const context = canvas.getContext('2d');
        const captureButton = document.getElementById('captureButton');
        const colorDisplay = document.getElementById('color-display');

        // Ù…ØªØºÙŠØ± Ù„ØªØ®Ø²ÙŠÙ† Ù…ØµØ¯Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        let stream;

        // 1. ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ğŸš€
        async function startCamera() {
            try {
                // Ø·Ù„Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ³Ø§Ø¦Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§)
                stream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = stream;
                
                // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø¨Ù…Ø¬Ø±Ø¯ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                video.onloadedmetadata = () => {
                    video.play();
                    captureButton.disabled = false;
                    captureButton.textContent = 'Ø§Ù„ØªÙ‚Ø· Ø§Ù„ØµÙˆØ±Ø©';
                };
            } catch (err) {
                console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§: ", err);
                alert("Ù„Ù… ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ù…ØªØµÙØ­ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª.");
            }
        }

        // 2. Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© ğŸ“¸
        function captureImage() {
            // ØªØ­Ø¯ÙŠØ¯ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù€ canvas Ù„ØªØ·Ø§Ø¨Ù‚ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            // Ø±Ø³Ù… Ø¥Ø·Ø§Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù€ Canvas
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // Ø¥ÙŠÙ‚Ø§Ù Ø¨Ø« Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù€ Canvas
            stream.getTracks().forEach(track => track.stop()); // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            video.style.display = 'none';
            canvas.style.display = 'block';
            captureButton.style.display = 'none';
            colorDisplay.textContent = "Ø§Ù„ØªÙ‚Ø·Øª! Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù†Ù‚Ø·Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆÙ†.";
        }
        
        captureButton.addEventListener('click', captureImage);
        
        // 3. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù„ÙˆÙ† Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù€ Canvas (Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ù„ØªÙ‚Ø·Ø©) ğŸ¨
        canvas.addEventListener('click', function(event) {
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¶ØºØ· Ø¯Ø§Ø®Ù„ Ø¹Ù†ØµØ± Ø§Ù„Ù€ Canvas
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯Ø§Ù„Ø© getImageData Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨ÙƒØ³Ù„ ÙÙŠ Ø§Ù„Ù†Ù‚Ø·Ø© (x, y)
            // 
            const pixelData = context.getImageData(x, y, 1, 1).data;
            
            // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙƒÙˆÙ† Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Ù…ØµÙÙˆÙØ© [Red, Green, Blue, Alpha]
            const r = pixelData[0];
            const g = pixelData[1];
            const b = pixelData[2];
            
            // ØªØ­ÙˆÙŠÙ„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¥Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ø³Ø¯Ø§Ø³ÙŠ Ø¹Ø´Ø±ÙŠ (Hex)
            const hexColor = `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;
            const rgbColor = `RGB(${r}, ${g}, ${b})`;

            // Ø¹Ø±Ø¶ Ø§Ù„Ù„ÙˆÙ†
            colorDisplay.style.backgroundColor = hexColor;
            colorDisplay.style.color = (r * 0.299 + g * 0.587 + b * 0.114) > 186 ? '#000' : '#fff'; // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ù†Øµ Ù„ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ø®Ù„ÙÙŠØ©
            colorDisplay.innerHTML = `${hexColor}<br>${rgbColor}`;

            console.log(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø·Ø© (${Math.floor(x)}, ${Math.floor(y)}) Ø§Ù„Ù„ÙˆÙ†: ${hexColor} (${rgbColor})`);
        });

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = startCamera;
    </script>

</body>
</html>
